<html>
<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
<script>
var graphdata = [];
$(document).ready(function(){

  $.getJSON("https://geoserver.nottinghamcity.gov.uk/parking/defstatus.json?t=637133157740144990",function(result){
  //$.getJSON("./test.json",function(result){
    //$.each(result.d2LogicalModel.payloadPublication.genericPublicationExtension.parkingStatusPublication.parkingRecordStatus, function(i, field){
    $.each(result.carParks.carPark, function(i, field){
      var cpname = field.definition.parkingRecord.parkingRecord.parkingName.values.value["#text"];
      var cpstatus = field.status.parkingRecord.parkingRecordStatus.parkingSiteStatus;
      var cpfill = parseFloat(field.status.parkingRecord.parkingRecordStatus.parkingOccupancy.parkingOccupancy);
      graphdata.push({ label: cpname, y: cpfill});
      //$("ol").append("hi");
      $("ol").append("<li>",field.definition.parkingRecord.parkingRecord.parkingName.values.value["#text"]," - ",field.status.parkingRecord.parkingRecordStatus.parkingSiteStatus," - ",field.status.parkingRecord.parkingRecordStatus.parkingOccupancy.parkingOccupancy,"%</li>");
    });

    var options = {
    	animationEnabled: true,
    	title: {
    		text: "Nottingham Car Parks"
    	},
    	axisY: {
    		title: "Capacity Filled (%)",
    		suffix: "%",
        maximum: 100,
    		includeZero: true
    	},
    	axisX: {
    		title: "Car Park Name"
    	},
    	data: [{
    		type: "column",
    		yValueFormatString: "#,##0.0#"%"",
    		dataPoints: graphdata
    	}]
    };
    $("#chartContainer").CanvasJSChart(options);
  });
});
</script>
</head>
<body>
  <div id="chartContainer" style="height: 300px; width: 100%;"></div>
  <script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
  <script src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>

<ol></ol>
</body>
</html>
